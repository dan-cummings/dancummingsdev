---
import { SITE_TITLE } from '../consts';
import HeaderLink from './HeaderLink.astro';
import SocialLinks from './SocialLinks.astro';
---

<header id="header" class="sticky top-0 z-50 m-0 px-4 bg-white shadow-[0_2px_8px_rgba(15,18,25,0.05)] transition-transform duration-300 ease-in-out">
	<nav class="flex items-center justify-between">
		<h2 class="text-base"><a href="/" class="no-underline">{SITE_TITLE}</a></h2>
		<div class="internal-links">
			<HeaderLink href="/">About</HeaderLink>
			<HeaderLink href="/blog">Blog</HeaderLink>
		</div>
		<SocialLinks />
	</nav>
</header>

<script>
	let lastScrollY = window.scrollY;
	let isHeaderVisible = true;

	function handleScroll() {
		const currentScrollY = window.scrollY;
		const header = document.getElementById('header');

		if (!header) return;

		// Only hide/show if scrolled more than 10px to avoid jitter
		if (Math.abs(currentScrollY - lastScrollY) < 10) return;

		if (currentScrollY > lastScrollY && currentScrollY > 100) {
			// Scrolling down and past 100px - hide header
			if (isHeaderVisible) {
				header.style.transform = 'translateY(-100%)';
				isHeaderVisible = false;
			}
		} else {
			// Scrolling up - show header
			if (!isHeaderVisible) {
				header.style.transform = 'translateY(0)';
				isHeaderVisible = true;
			}
		}

		lastScrollY = currentScrollY;
	}

	let ticking = false;
	function throttledScroll() {
		if (!ticking) {
			requestAnimationFrame(() => {
				handleScroll();
				ticking = false;
			});
			ticking = true;
		}
	}
	
	window.addEventListener('scroll', throttledScroll, { passive: true });
</script>
